<!DOCTYPE html>
<html>
  <!-- All the setting and imports for testing -->
  <head>
    <!-- add mocha css, to show results -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/mocha/3.2.0/mocha.css"
    />
    <!-- add mocha framework code -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mocha/3.2.0/mocha.js"></script>
    <script>
      // enable bdd-style testing
      mocha.setup("bdd");
    </script>
    <!-- add chai -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chai/3.5.0/chai.js"></script>
    <script>
      // chai has a lot of stuff, let's make assert global
      let assert = chai.assert;
      let errorData = { message: "This is not a available" };
      let award1 = {
        categoryList: [
          {
            nominationId: "2O3uskCBNnQPui5oxDm7",
            info: {
              winner: true,
              category: "MUSIC (Adaptation Score)",
              entity: "The Buddy Holly Story",
              year: 1978,
            },
          },
          {
            nominationId: "8uMkNK5PAc7b9dOxNp1P",
            info: {
              category: "MUSIC (Adaptation Score)",
              entity: "Pretty Baby",
              year: 1978,
              winner: false,
            },
          },
          {
            nominationId: "dy4iwyMU36yJKCUqpY8a",
            info: {
              category: "MUSIC (Adaptation Score)",
              entity: "The Wiz",
              year: 1978,
              winner: false,
            },
          },
        ],
      };
      let award2 = {
        categoryList: [
          {
            nominationId: "vU8LBpLWhAwbCaila4Un",
            info: {
              winner: true,
              category: "SCIENTIFIC AND TECHNICAL AWARD (Special Award)",
              entity:
                "To the Society of Motion Picture and Television Engineers - For one hundred years, the Society's members have nurtured technology, provided essential standards, and offered the expertise, support, tools and infrastructure for the creation and post-production of motion pictures.",
              year: 2015,
            },
          },
        ],
      };
      let body = {
        year: 6969,
        winner: false,
        category: "test",
        entity: "test",
      };
    </script>
  </head>

  <!-- main section with code and tests -->
  <body>
    <!-- Tests for GET Requests -->
    <script>
      describe("/nominations/category/ - GET - Singleton and Collection", async function () {
        // Testing the "MUSIC (Adaptation Score)" value
        it("MUSIC (Adaptation Score)", function () {
          fetch(
            `https://ludus-db-dot-csc131.appspot.com/nominations/category/${"MUSIC (Adaptation Score)"
              .split(" ")
              .join("%20")}`
          )
            .then((response) => response.json())
            .then((result) => assert.equal(result.json(), award1));
        });

        // Testing the "SCIENTIFIC AND TECHNICAL AWARD (Special Award)" value
        it("SCIENTIFIC AND TECHNICAL AWARD (Special Award)", function () {
          fetch(
            `https://ludus-db-dot-csc131.appspot.com/nominations/category/${"SCIENTIFIC AND TECHNICAL AWARD (Special Award)"
              .split(" ")
              .join("%20")}`
          )
            .then((response) => response.json())
            .then((result) => assert.equal(result.json(), award2));
        });

        // Testing the category query with no value
        it("No category parameter", function () {
          fetch("https://ludus-db-dot-csc131.appspot.com/nominations/category/")
            .then((response) => response.json())
            .then((result) => assert.equal(result.json(), errorData));
        });
      });

      describe("/nominations/category/ - POST - Singleton", async function () {
        // Testing a POST of a Singletion
        it("Test POST singleton - dose not exsist", function () {
          fetch(
            "https://ludus-db-dot-csc131.appspot.com/nominations/category/",
            {
              method: "POST",
              headers: {
                "Content-Type": "application/json;charset=utf-8",
              },
              body: body,
            }
          )
            .then((response) => response.json())
            .then((result) => assert.equal(result.json(), errorData));
        });
      });

      describe("/nominations/category/ - DELETE - Singleton and Collection", async function () {
        // Testing a DELETE of a collection
        it("Test DELETE collection - dose not exsist", function () {
          fetch(
            "https://ludus-db-dot-csc131.appspot.com/nominations/category/",
            {
              method: "DELETE",
              headers: {
                "Content-Type": "application/json;charset=utf-8",
              },
            }
          )
            .then((response) => response.json())
            .then((result) => assert.equal(result.json(), errorData));
        });
        // Testing a DELETE of a singleton
        it("Test DELETE  singleton - dose not exsist", function () {
          fetch(
            "https://ludus-db-dot-csc131.appspot.com/nominations/category/dummyname",
            {
              method: "DELETE",
              headers: {
                "Content-Type": "application/json;charset=utf-8",
              },
            }
          )
            .then((response) => response.json())
            .then((result) => assert.equal(result.json(), errorData));
        });
      });
    </script>

    <!-- the element with id="mocha" will contain test results -->
    <div id="mocha"></div>

    <!-- run tests! -->
    <script>
      mocha.run();
    </script>
  </body>
</html>
